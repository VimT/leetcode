//! 字母移位 II

pub fn shifting_letters(s: String, shifts: Vec<Vec<i32>>) -> String {
    let mut s = s.into_bytes();
    let len = s.len();
    let mut diff = vec![0; len + 1];
    for shift in shifts {
        let d = if shift[2] == 0 { -1 } else { 1 };
        diff[shift[0] as usize] += d;
        diff[shift[1] as usize + 1] -= d;
    }
    let mut cur = 0;
    for i in 0..len {
        cur += diff[i];
        s[i] = ((((s[i] - b'a') as i32 + cur) % 26 + 26) % 26) as u8 + b'a';
    }
    unsafe { String::from_utf8_unchecked(s) }
}

fn main() {
    assert_eq!(shifting_letters(String::from("yohvkbydmixayfkijtauchfvwblnvukuwyalfbuvvfmphdsdazwegandhchtfywifsbabraltffzpyqlujqnocaxhdjcwwdgyoeamvyqecrxkxcztiwpglvqzcorupspvgckcginbjmxiiwvixqgdjsrbiqhpmhoseqiuqhxkyllvefojhgqafdklynrxlwkeipvkowkrazqaeykczmhwrnwmsostqsxqrfgvkfodwjmjzwkjlpmpemzpvtetsjocfpsvbdimajifonfcvqlpooagpexmmauojsbfmtvdthxvjjbcrcesapfhyjmyuhsxcwesowklippotrcubqgivelnwoewggkluechywchlduxvabxmwopafmgnorzlzcfxbfpdgrqomknusliotmekdnwwfjpkbqupquqhyfnarxxaetnntpghijrdpadhypbfpaglgzazbteqmvguzfoygbntbvtadjaugyjvxgsllxnbnvaxoetetcncnwbzvdqcpeuejdoxnizqzoaqknsgyvifwsrcdfhgvxuhftngjyxslopszyeubnadozyddogedqdklaqlfgtgigecjejcemxsutvcvwm"
                                            ),  vec![vec![592,593,0],vec![491,513,0],vec![599,606,1],vec![210,521,0],vec![0,143,1],vec![422,445,1],vec![49,385,1],vec![270,321,1],vec![577,578,1],vec![78,308,0],vec![81,533,0],vec![88,474,0],vec![71,589,0],vec![30,319,1],vec![180,388,1],vec![284,430,1],vec![267,323,0],vec![306,309,1],vec![81,589,1],vec![586,590,1],vec![232,377,0],vec![191,591,0],vec![17,108,0],vec![214,531,1],vec![469,469,0],vec![75,328,0],vec![484,562,1],vec![340,354,0],vec![385,502,1],vec![439,600,0],vec![97,523,0],vec![102,324,0],vec![313,579,0],vec![238,360,0],vec![423,596,0],vec![556,582,0],vec![28,579,0],vec![232,270,1],vec![371,521,0],vec![477,564,0],vec![418,440,1],vec![114,511,1],vec![494,573,0],vec![487,492,0],vec![109,469,0],vec![336,473,0],vec![51,430,1],vec![463,514,0],vec![549,565,0],vec![0,80,1],vec![32,475,1],vec![520,538,1],vec![256,274,0],vec![336,475,1],vec![82,578,1],vec![350,416,1],vec![521,523,1],vec![297,489,0],vec![0,12,1],vec![155,592,0],vec![103,286,0],vec![506,607,0],vec![45,73,0],vec![157,517,1],vec![550,564,0],vec![165,182,0],vec![490,553,1],vec![590,602,1],vec![54,508,1],vec![586,591,1],vec![381,414,1],vec![145,601,0],vec![608,608,0],vec![545,586,1],vec![416,490,0],vec![327,570,1],vec![53,448,1],vec![249,395,0],vec![285,597,0],vec![207,542,0],vec![241,596,0],vec![172,590,0],vec![108,174,1],vec![454,537,0],vec![272,517,1],vec![370,580,1],vec![395,427,0],vec![1,410,1],vec![440,483,0],vec![146,593,0],vec![55,503,0],vec![472,535,0],vec![238,501,1],vec![192,554,0],vec![498,568,1],vec![481,566,0],vec![360,487,0],vec![42,175,1],vec![306,500,0],vec![222,377,0],vec![47,257,1],vec![291,430,0],vec![234,440,1],vec![114,160,0],vec![370,608,1],vec![75,253,1],vec![581,589,0],vec![330,447,0],vec![505,559,1],vec![367,409,0],vec![8,244,0],vec![92,254,1],vec![603,604,1],vec![531,595,1],vec![539,540,0],vec![142,313,1],vec![540,596,1],vec![331,359,0],vec![581,603,1],vec![501,501,1],vec![292,414,1],vec![61,116,0],vec![37,452,0],vec![115,119,1],vec![504,603,0],vec![36,76,1],vec![413,526,1],vec![209,443,1],vec![67,505,0],vec![382,454,0],vec![518,518,0],vec![445,478,0],vec![550,599,0],vec![457,542,0],vec![281,358,0],vec![226,452,1],vec![209,546,0],vec![400,499,1],vec![421,526,1],vec![83,362,0],vec![584,586,0],vec![348,356,1],vec![45,183,0],vec![137,262,1],vec![64,459,1],vec![60,262,1],vec![521,573,0],vec![442,497,1],vec![419,515,1],vec![313,493,1],vec![483,600,1],vec![602,606,0],vec![87,153,0],vec![513,551,0],vec![82,407,1],vec![487,569,1],vec![201,289,0],vec![607,608,1],vec![190,283,1],vec![378,402,1],vec![173,554,0],vec![540,601,1],vec![190,240,0],vec![428,458,1],vec![599,599,1],vec![48,310,1],vec![26,401,1],vec![5,70,0],vec![159,445,0],vec![315,589,1],vec![357,473,1],vec![69,380,1],vec![425,587,0],vec![191,468,0],vec![120,158,0],vec![143,418,1],vec![481,595,1],vec![350,549,1],vec![124,510,1],vec![67,242,1],vec![404,516,1],vec![502,587,0],vec![401,403,0],vec![460,468,0],vec![500,540,0],vec![272,368,1],vec![476,585,1],vec![11,125,1],vec![384,591,1],vec![452,457,0],vec![14,586,1],vec![232,417,1],vec![28,161,1],vec![239,385,1],vec![60,152,0],vec![97,119,1],vec![522,527,0],vec![103,531,0],vec![514,576,1],vec![393,502,0],vec![282,458,0],vec![25,551,1],vec![54,536,0],vec![139,150,0],vec![289,297,1],vec![602,605,0],vec![25,93,0],vec![486,534,1],vec![496,602,0],vec![46,276,0],vec![24,363,1],vec![530,593,1],vec![156,494,0],vec![192,438,1],vec![22,597,1],vec![127,371,1],vec![469,541,0],vec![290,544,0],vec![430,453,1],vec![241,401,1],vec![586,599,1],vec![201,544,1],vec![146,304,1],vec![351,371,1],vec![590,601,0],vec![234,579,0],vec![240,485,0],vec![67,499,0],vec![175,298,0],vec![223,242,1],vec![400,589,0],vec![100,106,1],vec![57,311,1],vec![310,334,1],vec![400,554,0],vec![346,350,1],vec![198,527,0],vec![511,584,1],vec![17,254,0],vec![279,577,0],vec![16,379,1],vec![402,499,1],vec![262,590,0],vec![549,565,0],vec![33,504,1],vec![343,460,1],vec![579,602,1],vec![519,548,0],vec![170,486,1],vec![445,523,1],vec![129,520,1],vec![296,500,0],vec![119,172,1],vec![352,497,0],vec![207,227,0],vec![91,372,0],vec![84,551,0],vec![261,272,0],vec![445,470,0],vec![512,562,0],vec![392,475,0],vec![524,605,1],vec![11,438,0],vec![265,449,0],vec![172,214,1],vec![243,353,1],vec![82,399,1],vec![74,257,0],vec![44,591,0],vec![474,506,0],vec![206,507,1],vec![151,386,1],vec![550,569,0],vec![202,494,0],vec![342,444,1],vec![98,397,0],vec![199,475,0],vec![532,602,1],vec![57,384,1],vec![498,548,0],vec![24,115,0],vec![109,226,1],vec![391,428,0],vec![320,467,1],vec![365,517,0],vec![474,605,1],vec![133,512,0],vec![228,342,1],vec![251,354,1],vec![552,581,0],vec![43,203,0],vec![370,454,0],vec![309,377,1],vec![340,411,1],vec![255,282,1],vec![129,201,0],vec![442,604,0],vec![400,496,0],vec![421,471,1],vec![269,452,0],vec![234,601,0],vec![518,531,1],vec![552,594,1],vec![283,386,1],vec![398,559,0],vec![591,601,0],vec![246,366,1],vec![389,586,1],vec![339,588,0],vec![513,587,1],vec![101,201,1],vec![293,559,1],vec![598,606,1],vec![351,531,1],vec![200,515,1],vec![360,569,1],vec![76,222,0],vec![252,477,0],vec![244,470,1],vec![247,566,0],vec![109,172,0],vec![537,606,0],vec![327,485,0],vec![281,350,1],vec![326,603,0],vec![57,188,1],vec![471,557,0],vec![480,557,0],vec![163,587,0],vec![7,416,1],vec![241,258,0],vec![201,425,1],vec![543,580,0],vec![123,575,0],vec![384,583,0],vec![507,536,1],vec![438,478,1],vec![207,543,0],vec![476,503,1],vec![146,530,1],vec![429,468,1],vec![221,254,0],vec![169,288,0],vec![125,178,0],vec![163,533,1],vec![367,464,1],vec![26,552,1],vec![388,438,0],vec![560,607,0],vec![388,588,0],vec![102,165,1],vec![106,405,1],vec![329,476,1],vec![119,556,0],vec![72,399,1],vec![581,608,0],vec![93,378,1],vec![148,568,0],vec![305,382,1],vec![299,584,0],vec![484,541,0],vec![405,544,0],vec![275,538,0],vec![84,303,0],vec![449,457,0],vec![117,276,0],vec![311,441,1],vec![238,319,0],vec![413,468,0],vec![399,428,1],vec![311,591,0],vec![501,507,0],vec![29,440,1],vec![270,320,0],vec![395,474,0],vec![344,592,1],vec![136,404,0],vec![259,548,0],vec![327,363,1],vec![233,354,0],vec![362,528,0],vec![564,569,0],vec![502,513,0],vec![178,262,1],vec![264,368,1],vec![348,596,0],vec![301,413,0],vec![338,578,0],vec![285,453,1],vec![330,360,0],vec![444,523,0],vec![92,537,0],vec![318,319,1],vec![314,548,0],vec![323,414,1],vec![606,606,0],vec![562,579,0],vec![435,529,1],vec![546,579,1],vec![200,583,1],vec![397,431,1],vec![560,568,0],vec![501,519,1],vec![82,89,0],vec![540,554,1],vec![341,581,0],vec![432,505,1],vec![129,556,0],vec![481,506,0],vec![110,174,0],vec![526,590,0],vec![551,564,1],vec![183,419,0],vec![308,492,0],vec![363,411,1],vec![44,588,0],vec![295,473,1],vec![202,521,0],vec![189,569,0],vec![129,132,1],vec![412,578,0],vec![271,526,0],vec![190,294,0],vec![81,200,0],vec![470,478,0],vec![211,398,0],vec![314,317,1],vec![423,453,1],vec![15,553,0],vec![240,522,1],vec![25,499,1],vec![125,271,0],vec![504,570,1],vec![1,464,1],vec![72,425,0],vec![447,462,1],vec![336,542,1],vec![146,425,1],vec![60,85,0],vec![594,598,1],vec![392,603,0],vec![386,464,1],vec![583,595,1],vec![400,524,0],vec![85,125,0],vec![139,406,0],vec![274,600,0],vec![331,555,1],vec![367,526,0],vec![125,459,0],vec![375,456,0],vec![88,183,0],vec![311,525,1],vec![474,567,1],vec![495,559,1],vec![600,601,1],vec![451,452,0],vec![243,311,0],vec![517,552,1],vec![292,343,1],vec![468,514,0],vec![544,607,1],vec![231,274,0],vec![4,258,0],vec![454,467,1],vec![323,343,1],vec![32,34,0],vec![507,540,0],vec![478,508,0],vec![185,395,1],vec![567,596,0],vec![88,495,0],vec![602,602,1],vec![370,493,0],vec![476,529,0],vec![58,78,1],vec![552,599,1],vec![133,426,1],vec![246,341,0],vec![282,501,1],vec![383,438,0],vec![169,213,1],vec![60,107,0],vec![479,542,0],vec![544,604,1],vec![463,473,1],vec![580,597,0],vec![484,503,0],vec![268,583,0],vec![142,155,0],vec![332,485,1],vec![417,474,0],vec![314,380,1],vec![545,558,1],vec![18,463,0],vec![512,537,1],vec![401,522,0],vec![555,598,1],vec![152,448,1],vec![414,429,0],vec![383,580,1],vec![2,72,0],vec![175,264,0],vec![140,604,0],vec![592,603,1],vec![184,349,1],vec![461,544,1],vec![54,325,1],vec![37,452,0],vec![400,481,1],vec![466,567,0],vec![319,603,0],vec![324,497,0],vec![237,253,1],vec![298,319,1],vec![491,606,0],vec![403,550,0],vec![366,563,1],vec![198,280,1],vec![38,339,1],vec![571,603,0],vec![29,164,1],vec![475,604,0],vec![49,173,0],vec![608,608,0],vec![262,470,1],vec![466,550,0],vec![329,357,1],vec![490,541,1],vec![341,394,1],vec![532,560,0],vec![95,259,1],vec![384,569,1],vec![250,444,1],vec![129,160,0],vec![200,220,1],vec![505,549,1],vec![241,519,1],vec![263,603,1],vec![74,463,1],vec![3,342,1],vec![535,548,0],vec![157,561,1],vec![407,531,1],vec![245,571,1],vec![228,250,1],vec![306,412,1],vec![428,578,1],vec![316,569,0],vec![327,432,0],vec![429,599,0],vec![364,481,0],vec![139,202,1],vec![392,472,1],vec![84,520,1],vec![502,531,0],vec![0,43,0],vec![336,462,1],vec![259,505,0],vec![422,475,1],vec![403,424,1],vec![523,585,0],vec![241,462,0],vec![484,573,0],vec![590,592,1],vec![69,562,0],vec![220,377,0],vec![576,600,0],vec![291,607,1],vec![44,542,1],vec![198,295,1],vec![396,481,1],vec![7,203,1],vec![73,224,1],vec![45,64,0],vec![190,312,0],vec![28,237,1],vec![303,574,1],vec![306,504,0],vec![392,517,0],vec![402,576,0],vec![321,577,0],vec![13,251,1],vec![221,221,1],vec![13,359,0],vec![484,564,1],vec![555,594,0],vec![517,522,0],vec![321,515,1],vec![382,598,1],vec![558,582,1],vec![245,479,1],vec![27,273,1],vec![346,429,0],vec![312,407,0],vec![409,456,1],vec![479,578,1],vec![108,412,1],vec![558,596,0],vec![540,603,1],vec![428,606,1],vec![297,407,0],vec![261,587,0],vec![295,363,1],vec![376,504,1],vec![102,326,1],vec![448,504,0],vec![406,560,0],vec![491,574,0],vec![331,408,0],vec![104,400,1],vec![583,606,0],vec![42,539,0],vec![405,460,0],vec![240,440,0],vec![454,575,1],vec![336,395,0],vec![219,334,1],vec![327,438,1],vec![364,553,0],vec![123,438,1],vec![603,605,1],vec![11,330,1],vec![472,482,1],vec![559,581,0],vec![481,492,0],vec![309,417,0],vec![348,366,0],vec![338,569,0],vec![96,536,1],vec![329,576,0],vec![541,593,1],vec![591,599,1],vec![130,289,0],vec![305,315,0],vec![0,55,0],vec![66,452,1],vec![456,485,0],vec![103,142,1],vec![84,475,1],vec![393,400,1],vec![10,581,0],vec![175,275,0],vec![81,117,0],vec![217,223,0],vec![229,429,1],vec![450,516,1],vec![18,586,1],vec![272,475,1],vec![346,529,1],vec![479,542,1],vec![497,585,0],vec![565,588,0],vec![194,506,1],vec![563,566,1],vec![566,573,0],vec![290,441,1],vec![292,480,1],vec![417,513,1]]
    ), "zrjymczgokycagmjltauchgwxdpsbctdfikwrlfggqxzrkykihenpkynsqwiskiusgqopfozhvwqfneyhtcyzmlhokrjdemqjzokxhlcrpfkanroixlfxcniordgkcfdjtowortyluxhrrfeqezplrabmudtbavcgufxjdtjwkyyiqsysqqbmrpwaodhnziuosagvzivfqndnrmvnkwqfaweuzvaawwdxxmmeupxnfruridsqswrvnvhxcbmzynuhkuxzdfinbkiemlbcwplqrrciqfynnbwqnyhowdiocqgerrkmalnajyophswierbfleoczftutywwbzibivklyjpqzsizjkooxgfkbyfmsjcaxddzmwnmydjelpryjxzdvyaiwzjgecxckidwybtnsjvfhruxqhtwprvslelteuzdgmauvbypqsszjtefgxpbcoydkdyywascpltepsyeoxqbgnjfknvkbmepbgobuxhxozkpmeugudmypakpnjrdqfwjrwqahzumelaofzcftlguphcgvxydeuxukduqhlczwrspuzaetbnaerzxcgriijvkpujzusqgxbbaxfaczdkurusvdtxl");
    assert_eq!(shifting_letters(String::from("abc"), vec![vec![0, 1, 0], vec![1, 2, 1], vec![0, 2, 1]]), "ace");
    assert_eq!(shifting_letters(String::from("dztz"), vec![vec![0, 0, 0], vec![1, 1, 1]]), "catz");
}